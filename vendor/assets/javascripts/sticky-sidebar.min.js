(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.StickySidebar={})})(this,function(a){'use strict';var b="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window,c=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a,c){(function(a,b){b(c)})(b,function(a){function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var c=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=function(){var a={topSpacing:0,bottomSpacing:0,containerSelector:!1,innerWrapperSelector:".inner-wrapper-sticky",stickyClass:"is-affixed",resizeSensor:!0,minWidth:!1},d=function(){function d(c){var e=this,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(b(this,d),this.options=d.extend(a,f),this.sidebar="string"==typeof c?document.querySelector(c):c,"undefined"==typeof this.sidebar)throw new Error("There is no specific sidebar element.");this.sidebarInner=!1,this.container=this.sidebar.parentElement,this.affixedType="STATIC",this.direction="down",this.support={transform:!1,transform3d:!1},this._initialized=!1,this._reStyle=!1,this._breakpoint=!1,this.dimensions={translateY:0,maxTranslateY:0,topSpacing:0,lastTopSpacing:0,bottomSpacing:0,lastBottomSpacing:0,sidebarHeight:0,sidebarWidth:0,containerTop:0,containerHeight:0,viewportHeight:0,viewportTop:0,lastViewportTop:0},["handleEvent"].forEach(function(a){e[a]=e[a].bind(e)}),this.initialize()}return c(d,[{key:"initialize",value:function(){var a=this;if(this._setSupportFeatures(),this.options.innerWrapperSelector&&(this.sidebarInner=this.sidebar.querySelector(this.options.innerWrapperSelector),null===this.sidebarInner&&(this.sidebarInner=!1)),!this.sidebarInner){var b=document.createElement("div");for(b.setAttribute("class","inner-wrapper-sticky"),this.sidebar.appendChild(b);this.sidebar.firstChild!=b;)b.appendChild(this.sidebar.firstChild);this.sidebarInner=this.sidebar.querySelector(".inner-wrapper-sticky")}if(this.options.containerSelector){var c=document.querySelectorAll(this.options.containerSelector);if(c=Array.prototype.slice.call(c),c.forEach(function(b){b.contains(a.sidebar)&&(a.container=b)}),!c.length)throw new Error("The container does not contains on the sidebar.")}"function"!=typeof this.options.topSpacing&&(this.options.topSpacing=parseInt(this.options.topSpacing)||0),"function"!=typeof this.options.bottomSpacing&&(this.options.bottomSpacing=parseInt(this.options.bottomSpacing)||0),this._widthBreakpoint(),this.calcDimensions(),this.stickyPosition(),this.bindEvents(),this._initialized=!0}},{key:"bindEvents",value:function(){window.addEventListener("resize",this,{passive:!0,capture:!1}),window.addEventListener("scroll",this,{passive:!0,capture:!1}),this.sidebar.addEventListener("update.stickySidebar",this),this.options.resizeSensor&&"undefined"!=typeof ResizeSensor&&(new ResizeSensor(this.sidebarInner,this.handleEvent),new ResizeSensor(this.container,this.handleEvent))}},{key:"handleEvent",value:function(a){this.updateSticky(a)}},{key:"calcDimensions",value:function(){if(!this._breakpoint){var a=this.dimensions;a.containerTop=d.offsetRelative(this.container).top,a.containerHeight=this.container.clientHeight,a.containerBottom=a.containerTop+a.containerHeight,a.sidebarHeight=this.sidebarInner.offsetHeight,a.sidebarWidth=this.sidebarInner.offsetWidth,a.viewportHeight=window.innerHeight,a.maxTranslateY=a.containerHeight-a.sidebarHeight,this._calcDimensionsWithScroll()}}},{key:"_calcDimensionsWithScroll",value:function(){var a=this.dimensions;a.sidebarLeft=d.offsetRelative(this.sidebar).left,a.viewportTop=document.documentElement.scrollTop||document.body.scrollTop,a.viewportBottom=a.viewportTop+a.viewportHeight,a.viewportLeft=document.documentElement.scrollLeft||document.body.scrollLeft,a.topSpacing=this.options.topSpacing,a.bottomSpacing=this.options.bottomSpacing,"function"==typeof a.topSpacing&&(a.topSpacing=parseInt(a.topSpacing(this.sidebar))||0),"function"==typeof a.bottomSpacing&&(a.bottomSpacing=parseInt(a.bottomSpacing(this.sidebar))||0),"VIEWPORT-TOP"===this.affixedType?a.topSpacing<a.lastTopSpacing&&(a.translateY+=a.lastTopSpacing-a.topSpacing,this._reStyle=!0):"VIEWPORT-BOTTOM"===this.affixedType&&a.bottomSpacing<a.lastBottomSpacing&&(a.translateY+=a.lastBottomSpacing-a.bottomSpacing,this._reStyle=!0),a.lastTopSpacing=a.topSpacing,a.lastBottomSpacing=a.bottomSpacing}},{key:"isSidebarFitsViewport",value:function(){var a=this.dimensions,b="down"===this.scrollDirection?a.lastBottomSpacing:a.lastTopSpacing;return this.dimensions.sidebarHeight+b<this.dimensions.viewportHeight}},{key:"observeScrollDir",value:function(){var a=this.dimensions;if(a.lastViewportTop!==a.viewportTop){var b="down"===this.direction?Math.min:Math.max;a.viewportTop===b(a.viewportTop,a.lastViewportTop)&&(this.direction="down"===this.direction?"up":"down")}}},{key:"getAffixType",value:function(){this._calcDimensionsWithScroll();var a=this.dimensions,b=a.viewportTop+a.topSpacing,c=this.affixedType;return b<=a.containerTop||a.containerHeight<=a.sidebarHeight?(a.translateY=0,c="STATIC"):c="up"===this.direction?this._getAffixTypeScrollingUp():this._getAffixTypeScrollingDown(),a.translateY=Math.max(0,a.translateY),a.translateY=Math.min(a.containerHeight,a.translateY),a.translateY=Math.round(a.translateY),a.lastViewportTop=a.viewportTop,c}},{key:"_getAffixTypeScrollingDown",value:function(){var a=this.dimensions,b=a.sidebarHeight+a.containerTop,c=a.viewportTop+a.topSpacing,d=a.viewportBottom-a.bottomSpacing,e=this.affixedType;return this.isSidebarFitsViewport()?a.sidebarHeight+c>=a.containerBottom?(a.translateY=a.containerBottom-b,e="CONTAINER-BOTTOM"):c>=a.containerTop&&(a.translateY=c-a.containerTop,e="VIEWPORT-TOP"):a.containerBottom<=d?(a.translateY=a.containerBottom-b,e="CONTAINER-BOTTOM"):b+a.translateY<=d?(a.translateY=d-b,e="VIEWPORT-BOTTOM"):a.containerTop+a.translateY<=c&&0!==a.translateY&&a.maxTranslateY!==a.translateY&&(e="VIEWPORT-UNBOTTOM"),e}},{key:"_getAffixTypeScrollingUp",value:function(){var a=this.dimensions,b=a.sidebarHeight+a.containerTop,c=a.viewportTop+a.topSpacing,d=a.viewportBottom-a.bottomSpacing,e=this.affixedType;return c<=a.translateY+a.containerTop?(a.translateY=c-a.containerTop,e="VIEWPORT-TOP"):a.containerBottom<=d?(a.translateY=a.containerBottom-b,e="CONTAINER-BOTTOM"):!this.isSidebarFitsViewport()&&a.containerTop<=c&&0!==a.translateY&&a.maxTranslateY!==a.translateY&&(e="VIEWPORT-UNBOTTOM"),e}},{key:"_getStyle",value:function(a){if("undefined"!=typeof a){var b={inner:{},outer:{}},c=this.dimensions;switch(a){case"VIEWPORT-TOP":b.inner={position:"fixed",top:c.topSpacing,left:c.sidebarLeft-c.viewportLeft,width:c.sidebarWidth};break;case"VIEWPORT-BOTTOM":b.inner={position:"fixed",top:"auto",left:c.sidebarLeft,bottom:c.bottomSpacing,width:c.sidebarWidth};break;case"CONTAINER-BOTTOM":case"VIEWPORT-UNBOTTOM":var e=this._getTranslate(0,c.translateY+"px");b.inner=e?{transform:e}:{position:"absolute",top:c.translateY,width:c.sidebarWidth};}return"VIEWPORT-TOP"===a||"VIEWPORT-BOTTOM"===a||"VIEWPORT-UNBOTTOM"===a||"CONTAINER-BOTTOM"===a?b.outer={height:c.sidebarHeight,position:"relative"}:void 0,b.outer=d.extend({height:"",position:""},b.outer),b.inner=d.extend({position:"relative",top:"",left:"",bottom:"",width:"",transform:""},b.inner),b}}},{key:"stickyPosition",value:function(a){if(!this._breakpoint){a=this._reStyle||a||!1;var b=this.options.topSpacing,c=this.options.bottomSpacing,e=this.getAffixType(),f=this._getStyle(e);if((this.affixedType!=e||a)&&e){var g="affix."+e.toLowerCase().replace("viewport-","")+".stickySidebar";for(var h in d.eventTrigger(this.sidebar,g),"STATIC"===e?d.removeClass(this.sidebar,this.options.stickyClass):d.addClass(this.sidebar,this.options.stickyClass),f.outer){var i="number"==typeof f.outer[h]?"px":"";this.sidebar.style[h]=f.outer[h]+i}for(var j in f.inner){var k="number"==typeof f.inner[j]?"px":"";this.sidebarInner.style[j]=f.inner[j]+k}var l="affixed."+e.toLowerCase().replace("viewport-","")+".stickySidebar";d.eventTrigger(this.sidebar,l)}else this._initialized&&(this.sidebarInner.style.left=f.inner.left);this.affixedType=e}}},{key:"_widthBreakpoint",value:function(){window.innerWidth<=this.options.minWidth?(this._breakpoint=!0,this.affixedType="STATIC",this.sidebar.removeAttribute("style"),d.removeClass(this.sidebar,this.options.stickyClass),this.sidebarInner.removeAttribute("style")):this._breakpoint=!1}},{key:"updateSticky",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._running||(this._running=!0,function(b){requestAnimationFrame(function(){switch(b){case"scroll":a._calcDimensionsWithScroll(),a.observeScrollDir(),a.stickyPosition();break;case"resize":default:a._widthBreakpoint(),a.calcDimensions(),a.stickyPosition(!0);}a._running=!1})}(b.type))}},{key:"_setSupportFeatures",value:function(){var a=this.support;a.transform=d.supportTransform(),a.transform3d=d.supportTransform(!0)}},{key:"_getTranslate",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this.support.transform3d?"translate3d("+a+", "+b+", "+c+")":!!this.support.translate&&"translate("+a+", "+b+")"}},{key:"destroy",value:function(){window.removeEventListener("resize",this,{capture:!1}),window.removeEventListener("scroll",this,{capture:!1}),this.sidebar.classList.remove(this.options.stickyClass),this.sidebar.style.minHeight="",this.sidebar.removeEventListener("update.stickySidebar",this);var a={inner:{},outer:{},inner:{position:"",top:"",left:"",bottom:"",width:"",transform:""},outer:{height:"",position:""}};for(var b in a.outer)this.sidebar.style[b]=a.outer[b];for(var c in a.inner)this.sidebarInner.style[c]=a.inner[c];this.options.resizeSensor&&"undefined"!=typeof ResizeSensor&&(ResizeSensor.detach(this.sidebarInner,this.handleEvent),ResizeSensor.detach(this.container,this.handleEvent))}}],[{key:"supportTransform",value:function(a){var b=!1,c=a?"perspective":"transform",d=c.charAt(0).toUpperCase()+c.slice(1),e=document.createElement("support"),f=e.style;return(c+" "+["Webkit","Moz","O","ms"].join(d+" ")+d).split(" ").forEach(function(a){if(void 0!==f[a])return b=a,!1}),b}},{key:"eventTrigger",value:function(a,b,c){try{var d=new CustomEvent(b,{detail:c})}catch(a){var d=document.createEvent("CustomEvent");d.initCustomEvent(b,!0,!0,c)}a.dispatchEvent(d)}},{key:"extend",value:function(a,b){var c={};for(var d in a)c[d]="undefined"==typeof b[d]?a[d]:b[d];return c}},{key:"offsetRelative",value:function(a){var b={left:0,top:0};do{var c=a.offsetTop,d=a.offsetLeft;isNaN(c)||(b.top+=c),isNaN(d)||(b.left+=d),a="BODY"===a.tagName?a.parentElement:a.offsetParent}while(a);return b}},{key:"addClass",value:function(a,b){d.hasClass(a,b)||(a.classList?a.classList.add(b):a.className+=" "+b)}},{key:"removeClass",value:function(a,b){d.hasClass(a,b)&&(a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," "))}},{key:"hasClass",value:function(a,b){return a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}},{key:"defaults",get:function(){return a}}]),d}();return d}();a.default=d,window.StickySidebar=d})}),d=function(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a["default"]:a}(c);a["default"]=d,a.__moduleExports=c,Object.defineProperty(a,"__esModule",{value:!0})});